áŸ¡. á€á¶ášááŸ‚á“á¶áŸ†á‡á¶á˜á¼á›áŠáŸ’á‹á¶á“
ááŸ’á‰á»áŸ†á“á¹á„ááŸ‚á“á¶áŸ†á‡áŸ†á á¶á“áŠá¾á˜áŸ’á”á¸á”á„áŸ’á€á¾ááŸ–

Sign Up Form: á¢á“á»á‰áŸ’á‰á¶áá±áŸ’á™á¢áŸ’á“á€á”áŸ’ášá¾á”á„áŸ’á€á¾áá‚áá“á¸á‡á¶á˜á½á™ Email, Password, á“á·á„ NameáŸ”
Log In Form: á¢á“á»á‰áŸ’á‰á¶áá±áŸ’á™á¢áŸ’á“á€á”áŸ’ášá¾á…á¼á›á”áŸ’ášá–áŸá“áŸ’á’áŠáŸ„á™á”áŸ’ášá¾ Credentials ProvideráŸ”
á”á‰áŸ’á á¶á‰á‘á·á“áŸ’á“áŸá™: á”á„áŸ’á á¶á‰á–áŸááŸŒá˜á¶á“á¢áŸ’á“á€á”áŸ’ášá¾ (á§. Name, Email) á“áŸ…á›á¾ Profile pageáŸ”
ááŸ’á‰á»áŸ†áŸá“áŸ’á˜ááá¶á¢áŸ’á“á€á”áŸ’ášá¾ Prisma á‡á¶á˜á½á™ SQLite (á¢á¶á…á•áŸ’á›á¶áŸáŸ‹á”áŸ’áá¼ášá‘áŸ… MongoDB á¬ Database á•áŸ’áŸáŸá„á”á¶á“) á“á·á„ Credentials Provider áŸá˜áŸ’ášá¶á”áŸ‹ AuthenticationáŸ”

áŸ¢. ášáŸ€á”á…áŸ† Project á“á·á„ Dependencies
á”á„áŸ’á€á¾á Project á“á·á„ Dependencies:
á”á¾á˜á·á“á‘á¶á“áŸ‹á˜á¶á“ Project:
bash

Collapse

Wrap

Run

Copy
npx create-next-app@latest my-auth-app
á‡áŸ’ášá¾áŸášá¾áŸ TypeScript, App Router, á“á·á„ Tailwind CSS (áŸáŸ’ášáŸá…á…á·ááŸ’á)áŸ”
áŠáŸ†á¡á¾á„ Dependencies:
bash

Collapse

Wrap

Run

Copy
npm install next-auth prisma @prisma/client bcrypt
npx prisma init
á€áŸ†áááŸ‹ Database:
á€áŸ‚ .env áŸá˜áŸ’ášá¶á”áŸ‹ SQLite (á¬ Database á•áŸ’áŸáŸá„):
env

Collapse

Wrap

Copy
DATABASE_URL="file:./db.sqlite"
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-secret-key
á”á„áŸ’á€á¾á Secret Key:
bash

Collapse

Wrap

Run

Copy
openssl rand -base64 32
á€áŸ‚ prisma/schema.prisma:
prisma

Collapse

Wrap

Copy
datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  name      String?
  createdAt DateTime @default(now())
}
Sync Database:
bash

Collapse

Wrap

Run

Copy
npx prisma migrate dev --name init
áŸ£. ášáŸ€á”á…áŸ† Authentication á‡á¶á˜á½á™ lib/auth.ts
á¢áŸ’á“á€á”á¶á“á“á·á™á¶á™áá¶á”áŸ’ášá¾ auth.ts á“áŸ…á€áŸ’á“á»á„ lib folderáŸ” ááŸ’á‰á»áŸ†á“á¹á„á”á„áŸ’á€á¾á lib/auth.ts áŸá˜áŸ’ášá¶á”áŸ‹á€áŸ†áááŸ‹ authOptions áŠáŸ‚á›á“á¹á„á”áŸ’ášá¾á“áŸ…á€áŸ’á“á»á„ API routeáŸ”

á”á„áŸ’á€á¾á lib/auth.ts:

ts

Collapse

Wrap

Copy
import { NextAuthOptions } from "next-auth";
import CredentialsProvider from "next-auth/providers/credentials";
import { PrismaClient } from "@prisma/client";
import bcrypt from "bcrypt";

const prisma = new PrismaClient();

export const authOptions: NextAuthOptions = {
  providers: [
    CredentialsProvider({
      name: "Credentials",
      credentials: {
        email: { label: "Email", type: "email" },
        password: { label: "Password", type: "password" },
      },
      async authorize(credentials) {
        if (!credentials?.email || !credentials?.password) {
          throw new Error("Missing email or password");
        }

        const user = await prisma.user.findUnique({
          where: { email: credentials.email },
        });

        if (!user || !user.password) {
          throw new Error("Invalid email or password");
        }

        const isValid = await bcrypt.compare(credentials.password, user.password);

        if (!isValid) {
          throw new Error("Invalid email or password");
        }

        return { id: user.id.toString(), email: user.email, name: user.name };
      },
    }),
  ],
  pages: {
    signIn: "/login",
  },
  session: {
    strategy: "jwt",
  },
  callbacks: {
    async jwt({ token, user }) {
      if (user) {
        token.id = user.id;
        token.email = user.email;
        token.name = user.name;
      }
      return token;
    },
    async session({ session, token }) {
      if (token) {
        session.user.id = token.id as string;
        session.user.email = token.email as string;
        session.user.name = token.name as string;
      }
      return session;
    },
  },
};
á…áŸ†áá»á…áŸáŸ†áá¶á“áŸ‹:
CredentialsProvider ááŸ’ášá¼áœá”á¶á“á€áŸ†áááŸ‹áŸá˜áŸ’ášá¶á”áŸ‹ Email/Password logináŸ”
prisma.user.findUnique á–á·á“á·ááŸ’á™á¢áŸ’á“á€á”áŸ’ášá¾á“áŸ…á€áŸ’á“á»á„ DatabaseáŸ”
bcrypt.compare á”áŸ’ášáŸ€á”á’áŸ€á” Password áŠáŸ‚á›á”á¶á“ HasháŸ”
callbacks á”á“áŸ’ááŸ‚á˜ User data (id, email, name) á‘áŸ…á€áŸ’á“á»á„ SessionáŸ”
á”á„áŸ’á€á¾á API Route:

á“áŸ… app/api/auth/[...nextauth]/route.ts:
ts

Collapse

Wrap

Copy
import NextAuth from "next-auth";
import { authOptions } from "@/lib/auth";

const handler = NextAuth(authOptions);
export { handler as GET, handler as POST };
á”á“áŸ’ááŸ‚á˜ SessionProvider:

á€áŸ‚ app/layout.tsx:
tsx

Collapse

Wrap

Copy
import { SessionProvider } from "next-auth/react";

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body>
        <SessionProvider>{children}</SessionProvider>
      </body>
    </html>
  );
}
áŸ¤. á”á„áŸ’á€á¾á Sign Up Form
á”á„áŸ’á€á¾á Sign Up Page:
á“áŸ… app/signup/page.tsx:
tsx

Collapse

Wrap

Copy
"use client";
import { useState } from "react";
import { useRouter } from "next/navigation";

export default function SignUp() {
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [name, setName] = useState("");
  const [error, setError] = useState("");
  const router = useRouter();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError("");

    try {
      const response = await fetch("/api/signup", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password, name }),
      });

      if (response.ok) {
        router.push("/login");
      } else {
        const data = await response.json();
        setError(data.message || "Something went wrong");
      }
    } catch (err) {
      setError("Failed to sign up");
    }
  };

  return (
    <div className="max-w-md mx-auto mt-10">
      <h1 className="text-2xl font-bold mb-5">Sign Up</h1>
      <form onSubmit={handleSubmit} className="space-y-4">
        <div>
          <label className="block">Name</label>
          <input
            type="text"
            value={name}
            onChange={(e) => setName(e.target.value)}
            className="w-full border p-2 rounded"
            required
          />
        </div>
        <div>
          <label className="block">Email</label>
          <input
            type="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            className="w-full border p-2 rounded"
            required
          />
        </div>
        <div>
          <label className="block">Password</label>
          <input
            type="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            className="w-full border p-2 rounded"
            required
          />
        </div>
        {error && <p className="text-red-500">{error}</p>}
        <button type="submit" className="w-full bg-blue-500 text-white p-2 rounded">
          Sign Up
        </button>
      </form>
    </div>
  );
}
á”á„áŸ’á€á¾á API Route áŸá˜áŸ’ášá¶á”áŸ‹ Sign Up:
á“áŸ… app/api/signup/route.ts:
ts

Collapse

Wrap

Copy
import { NextResponse } from "next/server";
import { PrismaClient } from "@prisma/client";
import bcrypt from "bcrypt";

const prisma = new PrismaClient();

export async function POST(request: Request) {
  try {
    const { email, password, name } = await request.json();

    if (!email || !password || !name) {
      return NextResponse.json({ message: "Missing fields" }, { status: 400 });
    }

    const existingUser = await prisma.user.findUnique({ where: { email } });
    if (existingUser) {
      return NextResponse.json({ message: "Email already exists" }, { status: 400 });
    }

    const hashedPassword = await bcrypt.hash(password, 10);

    await prisma.user.create({
      data: {
        email,
        password: hashedPassword,
        name,
      },
    });

    return NextResponse.json({ message: "User created" }, { status: 200 });
  } catch (error) {
    return NextResponse.json({ message: "Server error" }, { status: 500 });
  }
}
áŸ¥. á”á„áŸ’á€á¾á Log In Form
á”á„áŸ’á€á¾á Log In Page:
á“áŸ… app/login/page.tsx:
tsx

Collapse

Wrap

Copy
"use client";
import { useState } from "react";
import { signIn } from "next-auth/react";
import { useRouter } from "next/navigation";

export default function LogIn() {
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [error, setError] = useState("");
  const router = useRouter();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError("");

    const result = await signIn("credentials", {
      redirect: false,
      email,
      password,
    });

    if (result?.error) {
      setError("Invalid email or password");
    } else {
      router.push("/profile");
    }
  };

  return (
    <div className="max-w-md mx-auto mt-10">
      <h1 className="text-2xl font-bold mb-5">Log In</h1>
      <form onSubmit={handleSubmit} className="space-y-4">
        <div>
          <label className="block">Email</label>
          <input
            type="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            className="w-full border p-2 rounded"
            required
          />
        </div>
        <div>
          <label className="block">Password</label>
          <input
            type="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            className="w-full border p-2 rounded"
            required
          />
        </div>
        {error && <p className="text-red-500">{error}</p>}
        <button type="submit" className="w-full bg-blue-500 text-white p-2 rounded">
          Log In
        </button>
      </form>
    </div>
  );
}
áŸ¦. á”á‰áŸ’á á¶á‰á‘á·á“áŸ’á“áŸá™á“áŸ… Profile Page
á”á„áŸ’á€á¾á Profile Page:
á“áŸ… app/profile/page.tsx:
tsx

Collapse

Wrap

Copy
"use client";
import { useSession, signOut } from "next-auth/react";

export default function Profile() {
  const { data: session, status } = useSession();

  if (status === "loading") {
    return <div className="text-center mt-10">Loading...</div>;
  }

  if (!session) {
    return <div className="text-center mt-10">Please log in to view your profile.</div>;
  }

  return (
    <div className="max-w-md mx-auto mt-10">
      <h1 className="text-2xl font-bold mb-5">Profile</h1>
      <p><strong>Name:</strong> {session.user?.name}</p>
      <p><strong>Email:</strong> {session.user?.email}</p>
      <button
        onClick={() => signOut({ callbackUrl: "/login" })}
        className="mt-4 bg-red-500 text-white p-2 rounded"
      >
        Sign Out
      </button>
    </div>
  );
}
á€á¶ášá–á“áŸ’á™á›áŸ‹:
useSession Hook á‘á¶á‰á™á€ User data (name, email) á–á¸ SessionáŸ”
á”á¾á¢áŸ’á“á€á”áŸ’ášá¾á˜á·á“á‘á¶á“áŸ‹ Log In á‘áŸ á‘áŸ†á–áŸášá“á¹á„á”á„áŸ’á á¶á‰áŸá¶ášá±áŸ’á™ Log InáŸ”
á”áŸŠá¼áá»á„ Sign Out á“á¹á„ Redirect á‘áŸ… /login á”á“áŸ’á‘á¶á”áŸ‹á–á¸ Sign OutáŸ”
áŸ§. á€á¶ášá–á¶áš Profile Page (Optional)
á”á¾á¢áŸ’á“á€á…á„áŸ‹á€á¶ášá–á¶áš /profile áŠá¾á˜áŸ’á”á¸á±áŸ’á™ááŸ‚á¢áŸ’á“á€á”áŸ’ášá¾áŠáŸ‚á› Log In á”áŸ‰á»ááŸ’ááŸ„áŸ‡á¢á¶á…á…á¼á›á”á¶á“áŸ–

á”á„áŸ’á€á¾á Middleware:
á“áŸ… middleware.ts:
ts

Collapse

Wrap

Copy
import { withAuth } from "next-auth/middleware";

export default withAuth({
  pages: {
    signIn: "/login",
  },
});

export const config = {
  matcher: ["/profile"],
};
áŸ¨. áŸá¶á€á›áŸ’á”á„
áŠáŸ†áá¾ášá€á¶áš Project:
bash

Collapse

Wrap

Run

Copy
npm run dev
áŸá¶á€á›áŸ’á”á„ Flow:
á…á¼á›á‘áŸ… http://localhost:3000/signup áŠá¾á˜áŸ’á”á¸á”á„áŸ’á€á¾áá‚áá“á¸áŸ”
á…á¼á›á‘áŸ… http://localhost:3000/login áŠá¾á˜áŸ’á”á¸ Log InáŸ”
á”á“áŸ’á‘á¶á”áŸ‹á–á¸ Log In á‡áŸ„á‚á‡áŸá™ á¢áŸ’á“á€á“á¹á„ááŸ’ášá¼áœá”á¶á“ Redirect á‘áŸ… /profile áŠáŸ‚á›á”á„áŸ’á á¶á‰ Name á“á·á„ EmailáŸ”
á…á»á… Sign Out áŠá¾á˜áŸ’á”á¸ááŸ’ášá¡á”áŸ‹á‘áŸ… /logináŸ”
áŸ©. á”á‰áŸ’á á¶á‘á¼á‘áŸ… á“á·á„áœá·á’á¸áŠáŸ„áŸ‡áŸáŸ’ášá¶á™
Form á˜á·á“ Submit:
á–á·á“á·ááŸ’á™áá¶áá¾ URL á“áŸ…á€áŸ’á“á»á„ fetch (/api/signup) ááŸ’ášá¹á˜ááŸ’ášá¼áœáŸ”
ááŸ’ášá¼áœá”áŸ’ášá¶á€áŠáá¶ handleSubmit ááŸ’ášá¼áœá”á¶á“ Bind ááŸ’ášá¹á˜ááŸ’ášá¼áœá“áŸ…á€áŸ’á“á»á„ <form>áŸ”
á–á·á“á·ááŸ’á™ Console áŸá˜áŸ’ášá¶á”áŸ‹ Error (á§. 404 á”á¾ API route á˜á·á“ááŸ’ášá¹á˜ááŸ’ášá¼áœ)áŸ”
Log In á”ášá¶á‡áŸá™ ("Invalid credentials"):
á–á·á“á·ááŸ’á™ auth.ts áá¶áá¾ authorize function á€áŸ†á–á»á„ Query Database ááŸ’ášá¹á˜ááŸ’ášá¼áœáŸ”
ááŸ’ášá¼áœá”áŸ’ášá¶á€áŠáá¶ Password ááŸ’ášá¼áœá”á¶á“ Hash á“áŸ…á–áŸá› Sign Up (á”áŸ’ášá¾ bcrypt.hash)áŸ”
á”á¾á”áŸ’ášá¾ SQLite áŸá¼á˜á”áŸ’ášá¾ npx prisma studio áŠá¾á˜áŸ’á”á¸á–á·á“á·ááŸ’á™áá¶áá¾ User data ááŸ’ášá¼áœá”á¶á“ášá€áŸ’áŸá¶á‘á»á€áŸ”
á‘á·á“áŸ’á“áŸá™á˜á·á“á”á‰áŸ’á…á¶áŸ†á„á“áŸ… Profile Page:
ááŸ’ášá¼áœá”áŸ’ášá¶á€áŠáá¶ <SessionProvider> ááŸ’ášá¼áœá”á¶á“á”á“áŸ’ááŸ‚á˜á“áŸ…á€áŸ’á“á»á„ app/layout.tsxáŸ”
á–á·á“á·ááŸ’á™áá¶áá¾ callbacks á“áŸ…á€áŸ’á“á»á„ auth.ts á”á“áŸ’ááŸ‚á˜ User data (id, email, name) á‘áŸ… SessionáŸ”
á”á¾ session.user á‚áº undefined áŸá¼á˜á–á·á“á·ááŸ’á™ Console áŸá˜áŸ’ášá¶á”áŸ‹ Error á“áŸ… API route (/api/auth/[...nextauth])áŸ”
Database Errors:
á–á·á“á·ááŸ’á™ DATABASE_URL á“áŸ…á€áŸ’á“á»á„ .enváŸ”
á”á¾á”áŸ’ášá¾ Database á•áŸ’áŸáŸá„ (á§. MongoDB) áŸá¼á˜á€áŸ‚ schema.prisma á“á·á„ provider á‘áŸ… "mongodb"áŸ”
Redirect á˜á·á“áŠáŸ†áá¾ášá€á¶áš:
ááŸ’ášá¼áœá”áŸ’ášá¶á€áŠáá¶ router.push á“áŸ…á€áŸ’á“á»á„ Sign Up/Log In forms ááŸ’ášá¼áœá”á¶á“á áŸ…á”á“áŸ’á‘á¶á”áŸ‹á–á¸ Response á‡áŸ„á‚á‡áŸá™áŸ”
á–á·á“á·ááŸ’á™ pages.signIn á“áŸ…á€áŸ’á“á»á„ authOptions áá¶áá¾ááŸ’ášá¼áœá”á¶á“á€áŸ†áááŸ‹á‘áŸ… /logináŸ”
áŸ¡áŸ . á‚á“áŸ’á›á¹áŸ‡áŸá˜áŸ’ášá¶á”áŸ‹ášáŸ€á“á”á“áŸ’ááŸ‚á˜
á”á“áŸ’ááŸ‚á˜ Styling: á”áŸ’ášá¾ Tailwind CSS (áŠá¼á…á€áŸ’á“á»á„á§á‘á¶á ášááŸáá¶á„á›á¾) á¬ CSS framework á•áŸ’áŸáŸá„áŠá¾á˜áŸ’á”á¸á’áŸ’áœá¾á±áŸ’á™ Forms á˜á¾á›á‘áŸ…áŸáŸ’á¢á¶ááŸ”
á”á“áŸ’ááŸ‚á˜ Validation: á”áŸ’ášá¾ react-hook-form á¬ zod áŸá˜áŸ’ášá¶á”áŸ‹ Form validation (á§. á–á·á“á·ááŸ’á™ Password length, Email format)áŸ”
á”á“áŸ’ááŸ‚á˜ Providers: á”á¾á…á„áŸ‹á”á“áŸ’ááŸ‚á˜ Google/GitHub login áŸá¼á˜á€áŸ†áááŸ‹ Providers á”á“áŸ’ááŸ‚á˜á“áŸ…á€áŸ’á“á»á„ authOptions:
ts

Collapse

Wrap

Copy
import GoogleProvider from "next-auth/providers/google";
providers: [
  GoogleProvider({
    clientId: process.env.GOOGLE_CLIENT_ID!,
    clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
  }),
  CredentialsProvider({...}),
]
á¢á¶á“á¯á€áŸá¶áš:
NextAuth.js Docs: https://authjs.dev
Prisma Docs: https://www.prisma.io/docs
Debugging: á”á¾á‡á½á”á”á‰áŸ’á á¶ á”á¾á€ DevTools (F12) áŠá¾á˜áŸ’á”á¸á–á·á“á·ááŸ’á™ Network requests á“á·á„ Console errorsáŸ”



---------------------

á”áŸ’ášáŸá·á“á˜á¶á“ Error: This action with HTTP GET is not supported by NextAuth.js

áŸá¼á˜á–á·á“á·ááŸ’á™ folder structure á‡á¶á…á˜áŸ’á”á„



áŠá¼á…áŸ’á“áŸáŸ‡ áŸá¼á˜á•áŸ’á‰á¾ášá¿á„ áŸ¡ á“áŸáŸ‡:
ğŸ”¹ áŸá¼á˜á•áŸ’á‰á¾á¯á€áŸá¶áš route.ts áŠáŸ‚á›á“áŸ…á€áŸ’á“á»á„ path:

bash
Copy
Edit
/app/api/auth/[...nextauth]/route.ts
á¯á€áŸá¶ášá“áŸáŸ‡á‚áº áŸáŸ†áá¶á“áŸ‹á”áŸ†á•á»á áŠá¾á˜áŸ’á”á¸:

á…áŸ’á”á¶áŸáŸ‹áá¶ GET / POST method á”á¶á“ export ááŸ’ášá¹á˜ááŸ’ášá¼áœ

NextAuth(authOptions) ááŸ’ášá¼áœáá¶á˜ auth.ts áŠáŸ‚á›á¢áŸ’á“á€á”á¶á“áŸášáŸáŸášá˜á€

ğŸ¯ á“áŸ…á…á»á„á€áŸ’ášáŸ„á™á“áŸáŸ‡ ááŸ’á‰á»áŸ†áŸá“áŸ’á“á·áŠáŸ’á‹á¶á“áá¶:
á¢áŸ’á“á€á”á¶á“á”áŸ’ášá¾ UI signIn() ááŸ’ášá¹á˜ááŸ’ášá¼áœ

auth.ts ááŸ’ášá¹á˜ááŸ’ášá¼áœ

form á“áŸ… UI á˜á·á“á˜á¶á“ action á‘áŸ… /api/auth/signin/credentials

ááŸ‚ NextAuth middleware á¢á¶á… export methods áá»áŸ

âœ´ï¸ 99% á”á‰áŸ’á á¶á“áŸ…á€áŸ’á“á»á„ route.ts á¬á€áŸ folder path áá»áŸ

âœ… á§á‘á¶á ášááŸ route.ts ááŸ’ášá¹á˜ááŸ’ášá¼áœ (áŸá˜áŸ’ášá¶á”áŸ‹ App Router)
ts
Copy
Edit
// /app/api/auth/[...nextauth]/route.ts
import NextAuth from "next-auth";
import { authOptions } from "@/lib/auth"; // á¬ @/utils/auth.ts

const handler = NextAuth(authOptions);

export { handler as GET, handler as POST }; // VERY IMPORTANT âœ…




-------

1. á”áŸ’ášá¾ DevTools â†’ Network tab â†’ á–á·á“á·ááŸ’á™ POST /api/auth/callback/credentials
âœ… á’áŸ’áœá¾áŠá¼á…áŸ’á“áŸáŸ‡:

á…á»á… "Log In"

á‘áŸ… tab Network

ášá€ POST /api/auth/callback/credentials

